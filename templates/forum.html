{% extends "layout.html" %}

{% block content %}
<style>
   h2 {width: 50%; margin: auto; text-align: center; padding: 20px; color: white;}
   form {width: 70%; padding: 20px; margin:auto; background-color:#f5f5f5;}
  
   .new_form{ margin: 0; padding:0; background-color: white; display: inline; }
   a, a:hover,a:visited, a:focus {
    text-decoration:none;
}


.forum_link,.forum_link:hover { color:black;}
</style>
<!--if edit is requested, render this form-->
{% if edit_string %}
   <h2 >Update a Post</h2>
   <form  method="POST" action="http://localhost:5000/forum/" class="border" name="update_to_db">
      <input type="hidden" value="{{edit_string}}" name="update_id">
         <div class="form-group">
            <label>Category</label>
            <input class="form-control" placeholder="Hobbies" name="update_category" value="{{title}}">
         </div>
         <div class="form-group">
            <label>Text</label>
            <textarea class="form-control"  style="margin-bottom: 20px;" rows="3" placeholder="Taking over saturated selfies in Finnish forests" name="update_post">{{post}}</textarea>
            <button class="btn btn-primary">Update</button>
            <a href="{{ url_for('forum')}}" class="btn btn-primary" role="button" >Cancel</a>
         </div>
   </form>
      
{% else %}
<!--if else, render blank form-->

{% if session['username']%}
   <h2 >Create a Thread</h2>
   <form  method="POST" action="http://localhost:5000/forum/" class="border" name="submit">
      <div class="form-group">
         <label>Category</label>
         <input class="form-control" placeholder="Hobbies" name="category">
      </div>
      <div class="form-group">
         <label>Text</label>
         <textarea class="form-control"  rows="3" placeholder="Taking over saturated selfies in Finnish forests" name="post"></textarea>
         <button class="btn btn-primary" style="margin-top: 20px;">Submit</button>
      </div>
   </form>
{% endif %}

{% if message  %}
   <div class="col-4 offset-4" style="margin-top: 20px;">
     <p class="alert alert-success" role="alert">{{message}}
   </div>
 {% endif%}
 {% if error_message %}
 <div class="col-4 offset-4" style="margin-top: 20px;">
   
   <p class="alert alert-warning" role="alert">{{error_message}}</p>
    </div> 
   {% endif %}

{% endif %}
<!--cycle through posts from db-->
<div style="width: 70%; margin:auto; margin-top: 20px;">
{% for id,category,post,date,when_was,username in crud_read %}  
   <div class="card" >
      <div class="card-body">
      
         <h5 class="card-title">{{username}}</h5>
    <a href="{{ url_for('forum_thread',thread=id)}}" class="forum_link"> 
         <p class="card-text"><strong>{{category}}</strong></p>
         <p class="card-text"  style=" padding-bottom: 20px;">{{post}}</p>
      </a>
         <p class="card-subtitle mb-2 text-muted">{{when_was}}: {{date}}</p>    
        {% if  username == session['username']%}
         <form class="new_form" method="POST" action="http://localhost:5000/forum/" name="update" >
            <input type="hidden" value="{{id}}" name="edit">
            <input type="submit" class="btn btn-link" style="text-decoration: none; padding: none;" value="edit">
         </form>
         <form class="new_form" method="POST" action="http://localhost:5000/forum/" name="remove" >
            <input type="hidden" value="{{id}}" name="delete">
            <input type="submit" class="btn btn-link" style="text-decoration: none;  padding: none;" value="delete">
         </form>
         {% endif %}
   
      </div>  
   </div>  
      
{% endfor %}
</div>
   
{% endblock %} 